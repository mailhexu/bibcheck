# Story 1.4 - CrossRef API Integration: DOI Retrieval from Bibliographic Data

## Status
Draft

## Story Statement
As a user, I want the web interface to automatically retrieve DOIs using the CrossRef API when BibTeX entries are missing DOI information, so that I can complete my bibliographic data using available article metadata like title, author, and journal.

## Acceptance Criteria
- For entries missing DOI, the app can query CrossRef API using bibliographic information (title, author, journal)
- CrossRef API integration follows the specifications in `bibcheck-frontend/src/crossref.md`
- Retrieved DOIs are automatically added to the BibTeX entries
- UI shows when DOIs are retrieved via CrossRef API (distinct from arXiv API)
- Comprehensive error handling for failed CrossRef API requests
- Unit and integration tests for CrossRef API integration and DOI merging

## Dev Notes

**Previous Story Insights:**
- API integration framework established in Story 1.3
- arXiv API integration already implemented for DOI retrieval
- UI components support API update indicators

**Data Models:**
- CrossRef API response structure (JSON with items array containing DOI, title, author fields)
- BibTeX entry updates with CrossRef-retrieved DOIs

**API Specifications:**
- CrossRef API base URL: https://api.crossref.org/works
- Query parameters: query.bibliographic, query.title, query.author
- Response parsing: Extract DOI from JSON response items
[Source: bibcheck-frontend/src/crossref.md]

**Component Specifications:**
- CrossRef API service module: Handles requests to CrossRef API
- UI updates: Distinct indicators for CrossRef vs arXiv retrieved DOIs
[Source: architecture/front-end-architecture.md#api-integration]

**File Locations:**
- `src/services/api/crossrefApi.ts`
- `src/hooks/useApiIntegration.ts` (update to include CrossRef)
- `src/components/features/BibTeXEditor/BibTeXEditor.tsx` (update indicators)
[Source: architecture/source-tree.md]

**Testing Requirements:**
- Unit tests for CrossRef API service module (request/response handling)
- Integration tests for CrossRef-driven DOI updates
- Error handling tests for failed CrossRef API requests
[Source: architecture/testing-strategy.md]

**Technical Constraints:**
- CrossRef API logic must match Python bibcheck tool's behavior
- Use TypeScript for all new code
- Handle rate limiting and API response variations

## Tasks / Subtasks

1. Implement CrossRef API service module for DOI retrieval [Source: bibcheck-frontend/src/crossref.md]
2. Update API integration hook to include CrossRef DOI fetching [Source: architecture/front-end-architecture.md]
3. Update BibTeXEditor to distinguish CrossRef vs arXiv retrieved DOIs [Source: architecture/front-end-architecture.md]
4. Handle errors and display user feedback for failed CrossRef requests [Source: architecture/front-end-architecture.md]
5. Write unit and integration tests for CrossRef API integration [Source: architecture/testing-strategy.md]

## Project Structure Notes
All components and files should follow the structure defined in `architecture/source-tree.md`. No conflicts identified.
